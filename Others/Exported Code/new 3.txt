-- On Startup
Application.SaveValue("it_stock_manager", "e_Page", Page.GetSize().Width.."x"..Page.GetSize().Height);

-- On size
local ePage = Application.LoadValue("it_stock_manager", "e_Page");

PAGEWIDTH = String.ToNumber(String.Left(ePage, String.Find(ePage, "x", 1, false)-1));
PAGEHEIGHT = String.ToNumber(String.Mid(ePage, String.Find(ePage, "x", 1, false)+1, -1));

local objectList = Page.EnumerateObjects();

for i, object in pairs(objectList) do
	local objectType = Page.GetObjectType(object);

	if objectType ==0 then
		objProp = Button.GetProperties(object);
	elseif objectType ==1 then
		objProp = Label.GetProperties(object);
	elseif objectType ==2 then
		objProp = Paragraph.GetProperties(object);
	elseif objectType ==3 then
		objProp = Image.GetProperties(object);
	elseif objectType ==4 then
		objProp = Flash.GetProperties(object);
	elseif objectType ==5 then
		objProp = Video.GetProperties(object);
	elseif objectType ==6 then
		objProp = Web.GetProperties(object);
	elseif objectType ==7 then
		objProp = Input.GetProperties(object);
	elseif objectType ==8 then
		objProp = Hotspot.GetProperties(object);
	elseif objectType ==9 then
		objProp = Listbox.GetProperties(object);
	elseif objectType ==10 then
		objProp = Combobox.GetProperties(object);
	elseif objectType ==11 then
		objProp = Progress.GetProperties(object);
	elseif objectType ==12 then
		objProp = Tree.GetProperties(object);
	elseif objectType ==13 then
		objProp = RadioButton.GetProperties(object);
	elseif objectType ==14 then
		objProp = RichText.GetProperties(object);
	elseif objectType ==15 then
		objProp = CheckBox.GetProperties(object);
	elseif objectType ==16 then
		objProp = SlideShow.GetProperties(object);
	elseif objectType ==17 then
		objProp = Grid.GetProperties(object);
	elseif objectType ==18 then
		objProp = PDF.GetProperties(object);
	elseif objectType ==19 then
		objProp = QuickTime.GetProperties(object);
	elseif objectType ==20 then
		objProp = xButton.GetProperties(object);
	elseif objectType ==40 then
		objProp = Plugin.GetProperties(object);
	else
		Dialog.Message("Error", "Object undifined", MB_OK, MB_ICONSTOP, MB_DEFBUTTON1);
	end
		
	--perWidth = Math.Round((objProp.Width*100)/PAGEWIDTH, 0);
	--perHeight = Math.Round((objProp.Height*100)/PAGEHEIGHT, 0);
	perWidth = (objProp.Width*100)/PAGEWIDTH;
	perHeight = (objProp.Height*100)/PAGEHEIGHT;
	Debug.Print(object.."\r\n");
	Debug.Print("SIZE : "..objProp.Width.."x"..objProp.Height.." ==> "..perWidth.."% x "..perHeight.."% \r\n");
	
	perX = (objProp.X*100)/PAGEWIDTH;
	perY = (objProp.Y*100)/PAGEHEIGHT;
	Debug.Print("POS : "..objProp.X.." , "..objProp.Y.." ==> "..perX.."% , "..perY.."% \r\n");
	if e_PageWidth ~= PAGEWIDTH and e_PageHeight ~= PAGEHEIGHT then
		Debug.Print("***** Size Changed : "..e_PageWidth.." x "..e_PageHeight.."***** \r\n");
		NewWidth = (perWidth*e_PageWidth)/100;
		NewHeight = (perHeight*e_PageHeight)/100;
		
		NewX = (perX*e_PageWidth)/100
		NewY = (perY*e_PageHeight)/100
		
		Debug.Print(object.." -> NEW SIZE : "..NewWidth.."x"..NewHeight.."\r\n");
		Debug.Print(object.." -> NEW POS : "..NewX.." , "..NewY.."\r\n");

		
		if objectType ==0 then
			Button.SetSize(object, NewWidth, NewHeight);
			Button.SetPos(object, NewX, NewY);
		elseif objectType ==1 then
			Label.SetSize(object, NewWidth, NewHeight);
			Label.SetPos(object, NewX, NewY);
		elseif objectType ==2 then
			Paragraph.SetSize(object, NewWidth, NewHeight);
			Paragraph.SetPos(object, NewX, NewY);
		elseif objectType ==3 then
			Image.SetSize(object, NewWidth, NewHeight);
			Image.SetPos(object, NewX, NewY);
		elseif objectType ==4 then
			Flash.SetSize(object, NewWidth, NewHeight);
			Flash.SetPos(object, NewX, NewY);
		elseif objectType ==5 then
			Video.SetSize(object, NewWidth, NewHeight);
			Video.SetPos(object, NewX, NewY);
		elseif objectType ==6 then
			Web.SetSize(object, NewWidth, NewHeight);
			Web.SetPos(object, NewX, NewY);
		elseif objectType ==7 then
			Input.SetSize(object, NewWidth, NewHeight);
			Input.SetPos(object, NewX, NewY);
		elseif objectType ==8 then
			Hotspot.SetSize(object, NewWidth, NewHeight);
			Hotspot.SetPos(object, NewX, NewY);
		elseif objectType ==9 then
			ListBox.SetSize(object, NewWidth, NewHeight);
			ListBox.SetPos(object, NewX, NewY);
		elseif objectType ==10 then
			ComboBox.SetSize(object, NewWidth, NewHeight);
			ComboBox.SetPos(object, NewX, NewY);
		elseif objectType ==11 then
			Progress.SetSize(object, NewWidth, NewHeight);
			Progress.SetPos(object, NewX, NewY);
		elseif objectType ==12 then
			Tree.SetSize(object, NewWidth, NewHeight);
			Tree.SetPos(object, NewX, NewY);
		elseif objectType ==13 then
			RadioButton.SetSize(object, NewWidth, NewHeight);
			RadioButton.SetPos(object, NewX, NewY);
		elseif objectType ==14 then
			RichText.SetSize(object, NewWidth, NewHeight);
			RichText.SetPos(object, NewX, NewY);
		elseif objectType ==15 then
			CheckBox.SetSize(object, NewWidth, NewHeight);
			CheckBox.SetPos(object, NewX, NewY);
		elseif objectType ==16 then
			SlideShow.SetSize(object, NewWidth, NewHeight);
			SlideShow.SetPos(object, NewX, NewY);
		elseif objectType ==17 then
			Grid.SetSize(object, NewWidth, NewHeight);
			Grid.SetPos(object, NewX, NewY);
		elseif objectType ==18 then
			PDF.SetSize(object, NewWidth, NewHeight);
			PDF.SetPos(object, NewX, NewY);
		elseif objectType ==19 then
			QuickTime.SetSize(object, NewWidth, NewHeight);
			QuickTime.SetPos(object, NewX, NewY);
		elseif objectType ==20 then
			xButton.SetSize(object, NewWidth, NewHeight);
			xButton.SetPos(object, NewX, NewY);
		elseif objectType ==40 then
			Plugin.SetSize(object, NewWidth, NewHeight);
			Plugin.SetPos(object, NewX, NewY);
		else
			Dialog.Message("Error", "Object undifined", MB_OK, MB_ICONSTOP, MB_DEFBUTTON1);
		end
		Application.SaveValue("it_stock_manager", "e_Page", e_PageWidth.."x"..e_PageHeight);
	end
end
